<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>

    <style>
        .codex-editor__redactor{
            padding-bottom:50px !important;
        }
    </style>
</head>
<body>
    <h1>Type Below!</h1>
    <div id="editorjs" style="background-color:#f0f0f0;"></div>
    <button onclick="dispatchData(showResult)" style="background-color:black; color:white; border-radius:15%; display: inline;">Hit me to see HTML result</button>
    <button onclick="dispatchData(showRaw)" style="background-color:black; color:white; border-radius:15%; display: inline;">Hit me to see raw result</button>
    <br>
    <br>
    <br>
    <button onclick="dispatchData(logExtract)" style="background-color:grey; color:white; border-radius:15%; display: inline;">Hit me to log HTML data</button>
    <button onclick="dispatchData(logRaw)" style="background-color:grey; color:white; border-radius:15%; display: inline;">Hit me to log raw data</button>
    <br>
    <br>
    <div id="result"></div>
    <div id="resultRaw"></div>

</body>

<!-- Import Editor js-->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>

<!--Additional Tools-->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/header@latest"></script><!-- Header -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/delimiter@latest"></script><!-- Delimiter -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/list@latest"></script><!-- List -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/checklist@latest"></script><!-- Checklist -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/quote@latest"></script><!-- Quote -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/code@latest"></script><!-- Code -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/embed@latest"></script><!-- Embed -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script><!-- Table -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/link@latest"></script><!-- Link -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/marker@latest"></script><!-- Marker -->
<script src="https://cdn.jsdelivr.net/npm/@editorjs/inline-code@latest"></script><!-- Inline Code -->


<script>
    const editor = new EditorJS({ 
        // Id of Element that should contain the Editor 
        holder: 'editorjs', 
        
        /** 
         * Available Tools list. 
         * Pass Tool's class or Settings object for each Tool you want to use 
         */ 
        tools: { 
            heading: Header, 
            list: List 
        }, 
    })

    function dispatchData(dispatchFunction){
        //Take in a function object and dispatch editor.js block data to it
        editor.save().then((outputData) => {
                //console.log('Article data: ', outputData);
                dispatchFunction(outputData.blocks);
            }).catch((error) => {
                console.log('Saving failed: ', error)
            });
    }

    function logExtract(outputData){
        // Log extracted outputData from editor.js
        data = extractDatatoHTML(outputData);
        console.log(data)
    }

    function logRaw(outputData){
        // Logs raw data
        console.log(outputData)
    }

    function showResult(outputData){
        // Takes in outputData and shows the result to the result div
        result = document.getElementById("result")
        data = extractDatatoHTML(outputData);
        result.innerHTML = "<h1 style='color:red;'>HTML Result below</h1><br>";
        for (const element of data) {

            result.innerHTML += element
        }
    }

    function showRaw(outputData){
        // Takes in outputData and shows the raw result to the resultraw div
        result = document.getElementById("resultRaw")
        result.innerHTML = "<h1 style='color:red;'>Raw Result below</h1><br>";
        result.innerHTML += JSON.stringify(outputData, null, 2);
    }

    function extractDatatoHTML(outputData){
        // Takes in raw output data from editor js and turns it into a list of html strings
        formattedData = new Array();

        for (let contentBlock of outputData) {

            switch (contentBlock.type){
            case 'heading':
                //console.log("heading", contentBlock.data)
                formattedData.push(`<h${contentBlock.data.level}>${contentBlock.data.text}</h${contentBlock.data.level}>`)
                break
            case 'list': // Parse lists
                //console.log("list", contentBlock.data)
                if (contentBlock.data.style== "ordered"){
                    tagName = "ol"
                }else{
                    tagname="ul"
                }
                items = ""
                for (let item of contentBlock.data.items) {
                    items +=`<li>${item}</li>`
                }
                formattedData.push(`<${tagName}>${items}</${tagName}>`)
                break
            case 'paragraph':
                //console.log("paragraph", contentBlock.data)
                formattedData.push(`<p>${contentBlock.data.text}</p>`)
                break
            }
        }
    return formattedData;
    }
</script>
</html>